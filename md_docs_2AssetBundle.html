<!-- HTML header for doxygen 1.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=9"/>
    <meta name="generator" content="Doxygen 1.9.8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <title>Modern Renderer: Asset Bundles</title>
    <link href="tabs.css" rel="stylesheet" type="text/css"/>
    <script type="text/javascript" src="jquery.js"></script>
    <script type="text/javascript" src="dynsections.js"></script>
    <link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
    <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
    <link href="doxygen.css" rel="stylesheet" type="text/css" />
    <link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
    <script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
    <script type="text/javascript">
        DoxygenAwesomeDarkModeToggle.init()
    </script>
    <script type="text/javascript" src="doxygen-awesome-fragment-copy-button.js"></script>
    <script type="text/javascript">
        DoxygenAwesomeFragmentCopyButton.init()
    </script>
    <script type="text/javascript" src="doxygen-awesome-interactive-toc.js"></script>
    <script type="text/javascript">
        DoxygenAwesomeInteractiveToc.init()
    </script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
    <div id="titlearea">
        <table cellspacing="0" cellpadding="0">
            <tbody>
            <tr style="height: 56px;">
                <td id="projectalign" style="padding-left: 0.5em;">
                    <div id="projectname">Modern Renderer
                        &#160;<span id="projectnumber">3D renderer with modern features written in C++ with a C API</span>
                    </div>
                </td>
            </tr>
            </tbody>
        </table>
    </div>
    <!-- end header part --><!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('md_docs_2AssetBundle.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Asset Bundles</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md4"></a>You may want to load entire collections of assets at once, like if you start a new level and need all the sprites/fonts/ textures/... associated with that level. In this case you may want to use an asset bundle. An asset bundle is any directory or archive that contains a <code>manifest.json</code> at the root of that directory/archive (We'll get into the manifest) in a moment. The images, shaders (extension <code>.slang</code>/<code>.shader</code>), and audio from that source (recursively) will be loaded automatically and compound types (sprites, fonts, etc...) will be loaded from either information contained in <code>manifest.json</code> or from neighboring files (scroll down to see how you can automatically load sprites). All of those assets will then be made available through the function <code><a class="el" href="Assets_8h.html#a6ce9eeef2ceecb44f20c7882b69570c8" title="Gets an asset from a bundle, or OCT_NO_ASSET if no such asset exists.">oct_GetAsset(Oct_AssetBundle bundle, const char *name)</a></code>.</p>
<p>To load an asset bundle, use</p>
<div class="fragment"><div class="line">Oct_AssetBundle bundle = <a class="code hl_function" href="Assets_8h.html#a821a6cf143ac93968a236cb00c160b71">oct_LoadAssetBundle</a>(<span class="stringliteral">&quot;data.zip&quot;</span>);</div>
<div class="ttc" id="aAssets_8h_html_a821a6cf143ac93968a236cb00c160b71"><div class="ttname"><a href="Assets_8h.html#a821a6cf143ac93968a236cb00c160b71">oct_LoadAssetBundle</a></div><div class="ttdeci">OCTARINE_API Oct_AssetBundle oct_LoadAssetBundle(const char *filename)</div><div class="ttdoc">Loads an asset bundle from a file.</div></div>
</div><!-- fragment --><p>From here you may grab assets whenever you like via <code><a class="el" href="Assets_8h.html#a6ce9eeef2ceecb44f20c7882b69570c8" title="Gets an asset from a bundle, or OCT_NO_ASSET if no such asset exists.">oct_GetAsset(Oct_AssetBundle bundle, const char *name)</a></code>.</p>
<p><b>Warning</b> When you create an asset bundle, it queues the creation from the logic thread to then be loaded on the render thread. <code>oct_LoadAssetBundle</code> is <em>NOT</em> blocking, but it is blocking on the render thread, and if you attempt to get an asset from the bundle before it is done loading it will be blocking. For small amounts of assets you can likely ignore this quirk as it will likely just end up being a one-time &lt;100ms cost, but if you have large amounts of assets in a single bundle its worth keeping in mind.</p>
<h1><a class="anchor" id="autotoc_md5"></a>
manifest.json</h1>
<p>In the manifest you may specify an exclude list (directories, images, and sounds that will not be automatically loaded), fonts, bitmap fonts, and sprites. Here is an example of one:</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  &quot;exclude&quot;:</div>
<div class="line">          [</div>
<div class="line">            &quot;monogram.png&quot;,</div>
<div class="line">            &quot;directory&quot;</div>
<div class="line">          ],</div>
<div class="line">  &quot;fonts&quot;:</div>
<div class="line">          [</div>
<div class="line">            {</div>
<div class="line">              &quot;name&quot;: &quot;ttf_ubuntu&quot;,</div>
<div class="line">              &quot;files&quot;: [&quot;Ubuntu-Regular.ttf&quot;]</div>
<div class="line">            }</div>
<div class="line">          ],</div>
<div class="line">  &quot;bitmap fonts&quot;:</div>
<div class="line">          [</div>
<div class="line">            {</div>
<div class="line">              &quot;name&quot;: &quot;monogram&quot;,</div>
<div class="line">              &quot;image&quot;: &quot;monogram.png&quot;,</div>
<div class="line">              &quot;cell size&quot;: [6, 12],</div>
<div class="line">              &quot;unicode range&quot;: [32, 128]</div>
<div class="line">            }</div>
<div class="line">          ],</div>
<div class="line">  &quot;font atlases&quot;:</div>
<div class="line">          [</div>
<div class="line">            {</div>
<div class="line">              &quot;name&quot;: &quot;fnt_ubuntu&quot;,</div>
<div class="line">              &quot;font&quot;: &quot;ttf_ubuntu&quot;,</div>
<div class="line">              &quot;size&quot;: 20,</div>
<div class="line">              &quot;unicode ranges&quot;: [[32, 128], [1024, 1279]]</div>
<div class="line">            }</div>
<div class="line">          ],</div>
<div class="line">  &quot;sprites&quot;:</div>
<div class="line">          [</div>
<div class="line">            {</div>
<div class="line">              &quot;name&quot;: &quot;paladin from manifest&quot;,</div>
<div class="line">              &quot;texture&quot;:  &quot;sprites/paladinsfull.png&quot;,</div>
<div class="line">              &quot;frame count&quot;: 4,</div>
<div class="line">              &quot;repeat&quot;: true,</div>
<div class="line">              &quot;fps&quot;: 10,</div>
<div class="line">              &quot;start position&quot;:  [0, 0],</div>
<div class="line">              &quot;frame size&quot;: [32, 32],</div>
<div class="line">              &quot;padding&quot;:  [0, 0],</div>
<div class="line">              &quot;x stop&quot;: 0</div>
<div class="line">            }</div>
<div class="line">          ]</div>
<div class="line">}</div>
</div><!-- fragment --><p>The json parser is very strict, but it will tell exactly what's wrong if something is incorrect. Sprites do not need to specify every field, but name, texture, frame count, and frame size are required, everything else will choose sensible defaults. Font atlases may specify any number of Unicode ranges (where as if you create them at runtime without a bundle you'd need to load each range separately). In the above example, the font <code>fnt_ubuntu</code> will be created with 2 separate atlases internally for the two Unicode ranges specified (latin and cyrillic character sets).</p>
<h1><a class="anchor" id="autotoc_md6"></a>
Importing Sprites</h1>
<p>When you load an asset bundle from a directory or archive, the asset parser will automatically search for jsons that contain spritesheet information. This kind of json will have the format:</p>
<div class="fragment"><div class="line">{ </div>
<div class="line">  &quot;frames&quot;: </div>
<div class="line">  [</div>
<div class="line">    {}</div>
<div class="line">  ],</div>
<div class="line">  </div>
<div class="line">  &quot;meta&quot;: </div>
<div class="line">  {</div>
<div class="line">    &quot;image&quot;: &quot;IMAGE_FILENAME.png&quot;</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --><p>These jsons can be automatically exported by some image editing programs like Aseprite. The asset parser will load textures first, so if it finds the associated image it will load the frames specified as a sprite. You will need to export sprites in a certain way in Aseprite for this to work, however.</p>
<p><img src="exportanimation.png" alt="image" class="inline"/></p>
<p>As long as the image and json are in the same directory and you follow the above image, Octarine will load your sprites automatically under the name of the json.</p>
<p>For example, if you have </p><pre class="fragment">paladinspr.png
paladinspr.json
</pre><p> You would load the sprite in code with</p>
<div class="fragment"><div class="line"><a class="code hl_typedef" href="Common_8h.html#a0606b02567f2eeec2dcc4be467d06123">Oct_Sprite</a> paladin_sprite = <a class="code hl_function" href="Assets_8h.html#a6ce9eeef2ceecb44f20c7882b69570c8">oct_GetAsset</a>(asset_bundle, <span class="stringliteral">&quot;paladinspr.json&quot;</span>);</div>
<div class="ttc" id="aAssets_8h_html_a6ce9eeef2ceecb44f20c7882b69570c8"><div class="ttname"><a href="Assets_8h.html#a6ce9eeef2ceecb44f20c7882b69570c8">oct_GetAsset</a></div><div class="ttdeci">OCTARINE_API Oct_Asset oct_GetAsset(Oct_AssetBundle bundle, const char *name)</div><div class="ttdoc">Gets an asset from a bundle, or OCT_NO_ASSET if no such asset exists.</div></div>
<div class="ttc" id="aCommon_8h_html_a0606b02567f2eeec2dcc4be467d06123"><div class="ttname"><a href="Common_8h.html#a0606b02567f2eeec2dcc4be467d06123">Oct_Sprite</a></div><div class="ttdeci">Oct_Asset Oct_Sprite</div><div class="ttdoc">2D animation</div><div class="ttdef"><b>Definition</b> Common.h:80</div></div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
